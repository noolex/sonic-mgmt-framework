<?xml version="1.0" encoding="utf-8"?>
<ROOT>
    <MACRODEF name="SERVICE-POLICY-INTERFACE-OPTIONS">
        <PARAM name="interface-options" help="Show policies applied for interface" ptype="SUBCOMMAND" mode="switch">
            <PARAM name="Ethernet" help="Ethernet interface" ptype="SUBCOMMAND" mode="subcommand">
                <PARAM name="eth-if-id" help="Ethernet interface id" ptype="UINT" />
            </PARAM>
            <PARAM name="PortChannel" help="PortChannel interface" ptype="SUBCOMMAND" mode="subcommand">
                <PARAM name="po-if-id" help="PortChannel interface id" ptype="LAG_ID"/>
            </PARAM>
            <PARAM name="Vlan" help="Vlan interface" ptype="SUBCOMMAND" mode="subcommand">
                <PARAM name="vlan-if-id" help="Vlan interface id" ptype="VLAN_ID"/>
            </PARAM>
        </PARAM>
    </MACRODEF>

    <MACRODEF name="FBS-POLICY-TYPES">
        <PARAM name="type" help="Policy type" ptype="SUBCOMMAND" mode="subcommand" optional="arg1" order="true">
            <PARAM name="fbs-policy-type" help="Policy type" ptype="SUBCOMMAND" mode="switch">
                <PARAM name="qos" help="QoS Policy" ptype="SUBCOMMAND" mode="subcommand" />
                <PARAM name="monitoring" help="Monitoring Policy" ptype="SUBCOMMAND" mode="subcommand" />
                <PARAM name="forwarding" help="Forwarding Policy" ptype="SUBCOMMAND" mode="subcommand" />
                <PARAM name="copp" help="Forwarding Policy" ptype="SUBCOMMAND" mode="subcommand" />
            </PARAM>
        </PARAM>
    </MACRODEF>

    <MACRODEF name="FBS-CLASSIFIER-TYPES">
    </MACRODEF>

    <MACRODEF name="MATCH-ADDRESS-TYPES-ADD">
        <PARAM name="address-types" help="address-types" ptype="SUBCOMMAND" mode="switch">
            <PARAM name="mac" help="Match on arg1 MAC address" ptype="SUBCOMMAND" mode="subcommand">
                <PARAM name="arg1-mac-addr-options-switch" help="" ptype="SUBCOMMAND" mode="switch">
                    <PARAM name="arg1-mac-addr" help="arg2 MAC address" ptype="ACL_MAC_ADDR">
                        <PARAM name="arg1-mac-mask" help="arg2 MAC address mask" ptype="ACL_MAC_ADDR"/>
                    </PARAM>
                    <PARAM name="arg1-mac-host" help="arg2 MAC address" ptype="SUBCOMMAND" mode="subcommand"  value="host">
                        <PARAM name="arg1-mac-addr" help="arg2 MAC address value" ptype="ACL_MAC_ADDR"/>
                    </PARAM>
                </PARAM>
            </PARAM>
            <PARAM name="ip" help="Match on arg1 IPv4 address" ptype="SUBCOMMAND" mode="subcommand">
                <PARAM name="arg1-ip-addr-options-switch" help="" ptype="SUBCOMMAND" mode="switch">
                    <PARAM name="arg1-ip-prefix" help="arg2 IPv4 address prefix" ptype="IP_ADDR_MASK"/>
                    <PARAM name="arg1-ip-host" help="arg2 host IPv4 address" ptype="SUBCOMMAND" mode="subcommand" value="host">
                        <PARAM name="arg1-ip" help="arg2 IPv4 address value" ptype="DOTTED_QUAD"/>
                    </PARAM>
                </PARAM>
            </PARAM>
            <PARAM name="ipv6" help="Match on arg1 IPv6 address" ptype="SUBCOMMAND" mode="subcommand">
                <PARAM name="arg1-ip-addr-options-switch" help="" ptype="SUBCOMMAND" mode="switch">
                    <PARAM name="arg1-ip-prefix" help="arg2 IPv6 address prefix" ptype="IPV6_ADDR_MASK"/>
                    <PARAM name="arg1-ip-host" help="arg2 host IPv6 address" ptype="SUBCOMMAND" mode="subcommand" value="host">
                        <PARAM name="arg1-ip" help="arg2 IPv6 address value" ptype="IPV6_ADDR"/>
                    </PARAM>
                </PARAM>
            </PARAM>
        </PARAM>
    </MACRODEF>

    <MACRODEF name="MATCH-ADDRESS-TYPES-DEL">
        <PARAM name="address-types" help="address-types" ptype="SUBCOMMAND" mode="switch">
            <PARAM name="mac" help="Delete match on arg1 MAC address" ptype="SUBCOMMAND" mode="subcommand"/>
            <PARAM name="ip" help="Delete match on arg1 IP address" ptype="SUBCOMMAND" mode="subcommand"/>
            <PARAM name="ipv6" help="Delete match on arg1 IPv6 address" ptype="SUBCOMMAND" mode="subcommand"/>
        </PARAM>
    </MACRODEF>

    <MACRODEF name="CLASSIFIER-DESCRIPTION">
        <COMMAND name="description" help="Configure classifier description">
            <PARAM name="description-value" help="String" ptype="DESCRIPTION"/>
            <ACTION builtin="clish_pyobj">sonic_cli_fbs set_classifier_description ${fbs-class-name} ${description-value}</ACTION>
        </COMMAND>

        <COMMAND name="no description" help="Clear classifier description">
            <ACTION builtin="clish_pyobj">sonic_cli_fbs clear_classifier_description ${fbs-class-name}</ACTION>
        </COMMAND>
    </MACRODEF>

    <MACRODEF name="FBS-DIRECTION-TYPES">
        <PARAM name="fbs-direction-type" help="Policy type" ptype="SUBCOMMAND" mode="switch">
            <PARAM name="in" help="Ingress direction" ptype="SUBCOMMAND" mode="subcommand"/>
            <PARAM name="out" help="Egress direction" ptype="SUBCOMMAND" mode="subcommand" test='"${fbs-policy-type}" = "qos"'/>
        </PARAM>
    </MACRODEF>

    <MACRODEF name="FBS-POLICY-BINDING-OPTIONS">
        <COMMAND name="service-policy" help="Apply ingress or egress policy">
            <MACRO name="FBS-POLICY-TYPES" arg="false" />
            <MACRO name="FBS-DIRECTION-TYPES"/>
            <PARAM name="fbs-policy-name" help="Name of the policy (Max size 63)" ptype="STRING_63"/>
            <ACTION builtin="clish_pyobj">sonic_cli_fbs bind_policy ${fbs-policy-name} ${fbs-policy-type} ${fbs-direction-type} ${iface} ${vlan_name} ${po_name}</ACTION>
        </COMMAND>

        <COMMAND name="no service-policy" help="Remove ingress or egress policy">
            <MACRO name="FBS-POLICY-TYPES" arg="false" />
            <MACRO name="FBS-DIRECTION-TYPES"/>
            <ACTION builtin="clish_pyobj">sonic_cli_fbs unbind_policy ${fbs-policy-type} ${fbs-direction-type} ${iface} ${vlan_name} ${po_name}</ACTION>
        </COMMAND>
    </MACRODEF>

    <MACRODEF name="FBS-TCP-FLAGS">
        <PARAM name="fin-options" help="" ptype="SUBCOMMAND" mode="switch" optional="true" order="true">
            <PARAM name="fin" help="arg1 packets with FIN TCP flag set" ptype="SUBCOMMAND" mode="subcommand"/>
            <PARAM name="not-fin" help="arg1 packets with FIN TCP flag cleared" ptype="SUBCOMMAND" mode="subcommand"/>
        </PARAM>
        <PARAM name="syn-options" help="" ptype="SUBCOMMAND" mode="switch" optional="true" order="true">
            <PARAM name="syn" help="arg1 packets with SYN TCP flag set" ptype="SUBCOMMAND" mode="subcommand"/>
            <PARAM name="not-syn" help="arg1 packets with SYN TCP Flag cleared" ptype="SUBCOMMAND" mode="subcommand"/>
        </PARAM>
        <PARAM name="rst-options" help="" ptype="SUBCOMMAND" mode="switch" optional="true" order="true">
            <PARAM name="rst" help="arg1 packets with RST TCP flag set" ptype="SUBCOMMAND" mode="subcommand"/>
            <PARAM name="not-rst" help="arg1 packets with RST TCP flag cleared" ptype="SUBCOMMAND" mode="subcommand"/>
        </PARAM>
        <PARAM name="psh-options" help="" ptype="SUBCOMMAND" mode="switch" optional="true" order="true">
            <PARAM name="psh" help="arg1 packets with PSH TCP flag set" ptype="SUBCOMMAND" mode="subcommand"/>
            <PARAM name="not-psh" help="arg1 packets with PSH TCP flag cleared" ptype="SUBCOMMAND" mode="subcommand"/>
        </PARAM>
        <PARAM name="ack-options" help="" ptype="SUBCOMMAND" mode="switch" optional="true" order="true">
            <PARAM name="ack" help="arg1 packets with ACK TCP flag set" ptype="SUBCOMMAND" mode="subcommand"/>
            <PARAM name="not-ack" help="arg1 packets with ACK TCP flag cleared" ptype="SUBCOMMAND" mode="subcommand"/>
        </PARAM>
        <PARAM name="urg-options" help="" ptype="SUBCOMMAND" mode="switch" optional="true" order="true">
            <PARAM name="urg" help="arg1 packets with URG TCP flag set" ptype="SUBCOMMAND" mode="subcommand"/>
            <PARAM name="not-urg" help="arg1 packets with URG TCP flag cleared" ptype="SUBCOMMAND" mode="subcommand"/>
        </PARAM>
    </MACRODEF>

    <MACRODEF name="FBS-NEXT-HOP-OPTIONS">
        <PARAM name="next-hop" help="Next hop" ptype="SUBCOMMAND" mode="subcommand" />
        <PARAM name="ip-address" help="arg1 address Value" ptype="arg2"/>
        <PARAM name="vrf" help="Next hop VRF" ptype="SUBCOMMAND" mode="subcommand" optional="true" order="true">
            <PARAM name="vrf-options" help="" ptype="SUBCOMMAND" mode="switch">
                <PARAM name="vrf-name" help="Next hop VRF name" ptype="VRF_NAME" />
                <PARAM name="default" help="Default VRF" ptype="SUBCOMMAND" mode="subcommand"/>
            </PARAM>
        </PARAM>
    </MACRODEF>

    <MACRODEF name="FBS-NEXT-HOP-PRIORITY">
        <PARAM name="priority" help="Priority of the Next hop" ptype="SUBCOMMAND" mode="subcommand" optional="true" order="true" test='"${egress-intf-options}" != "null"'>
            <PARAM name="priority-value" help="Priority value" ptype="RANGE_1_65535"/>
        </PARAM>
    </MACRODEF>

    <MACRODEF name="FBS-EGRESS-INTF-OPTIONS">
        <PARAM name="egress-intf-options" help="" ptype="SUBCOMMAND" mode="switch">
            <PARAM name="null" help="Drop traffic" ptype="SUBCOMMAND" mode="subcommand"/>
            <PARAM name="Ethernet" help="Redirect traffic to ethernet interface" ptype="SUBCOMMAND" mode="subcommand">
                <PARAM name="port-id" help="Port number" ptype="UINT" completion="false"/>
            </PARAM>
            <PARAM name="PortChannel" help="Redirect traffic to portchannel interface" ptype="SUBCOMMAND" mode="subcommand">
                <PARAM name="portchannel-id" help="Lag number" ptype="LAG_ID" completion="false"/>
            </PARAM>
        </PARAM>
    </MACRODEF>
</ROOT>
