<?xml version="1.0" encoding="UTF-8"?>

<!--
Copyright 2019 Dell, Inc.  

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
--> 

<CLISH_MODULE
    xmlns="http://www.dellemc.com/sonic/XMLSchema"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:xi="http://www.w3.org/2001/XInclude"
    xsi:schemaLocation="http://www.dellemc.com/sonic/XMLSchema
                        http://www.dellemc.com/sonic/XMLSchema/clish.xsd"
    >
<!--=========================================================================-->

<PTYPE
     name="STP_FORWARD_DELAY"
     method="integer"
     pattern="4..30"
     help=""
     />
 <!--=======================================================-->
 <PTYPE
      name="STP_HELLO_TIME"
      method="integer"
      pattern="1..10"
      help=""
      />
  <!--=======================================================-->
  <PTYPE
       name="STP_MAX_AGE"
       method="integer"
       pattern="6..40"
       help=""
       />
   <!--=======================================================-->
   <PTYPE
        name="STP_PRIORITY"
        method="integer"
        pattern="0..61440"
        help=""
        />
    <!--=======================================================-->
    <PTYPE
         name="STP_FORCE_VERSION"
         method="integer"
         pattern="( [0] | [2])"
         help=""
         />
     <!--=======================================================-->
     <PTYPE
          name="STP_COST"
          method="integer"
          pattern="1..200000000"
          help=""
          />
      <!--=======================================================-->
      <PTYPE
           name="STP_PORT_PRIORITY"
           method="integer"
           pattern="0..240"
           help=""
           />
       <!--=======================================================-->
      <PTYPE
           name="STP_VLAN_ID"
           method="integer"
           pattern="1..4094"
           help="VLAN ID"
           />
       <!--=======================================================-->
      <PTYPE
           name="STP_GUARD_ROOT_TIMEOUT"
           method="integer"
           pattern="5..600"
           help=""
           />
       <!--=======================================================-->
<PTYPE
    name="STP_GUARD_TYPE"
    method="select"
    pattern="root loop none"
    help="Guard type"
/>
<!--=======================================================-->

<VIEW name="enable-view">
    <COMMAND
        name="show spanning-tree"
        help="Show spanning tree information"
        >
        <PARAM
            name="vlan"
            help="VLAN specific information"
            ptype="SUBCOMMAND"
            mode="subcommand"
            optional="true"
        >
        <PARAM
            name="vlan-id"
            help="(-) or (,) separated individual VLAN IDs and ranges of VLAN IDs; for example, 20,70-100,142"
            ptype="VLAN_RANGE"
            >
            <PARAM
                name="interface"
                help="Interface specific information"
                ptype="SUBCOMMAND" mode="subcommand" optional="true"
                >
                <PARAM
                    name="name"
                    help="VLAN member interface name"
                    ptype="STRING"
                >
                </PARAM>
            </PARAM>
        </PARAM>
    </PARAM>
    <ACTION builtin="clish_pyobj">
        sonic_cli_stp process_stp_show show_stp.j2 ${vlan-id} ${name} 
    </ACTION>
    <DOCGEN>
        <DESCRIPTION>
            Shows spanning-tree information
        </DESCRIPTION>
        <USAGE>
            This command is useful in viewing the spanning-tree information
        </USAGE>
        <EXAMPLE summary="show spanning-tree">
			sonic(config)# do show spanning-tree
            Spanning-tree Mode: PVST
             
            VLAN 100 - STP instance 0
            ------------------------------------------------------------------------------------------------------------ 
            STP Bridge Parameters:
             
            Bridge            Bridge    Bridge    Bridge    Hold  LastTopology  Topology  
            Identifier        MaxAge    Hello     FwdDly    Time  Change        Change    
            hex               sec       sec       sec       sec   sec           cnt       
            80643c2c99a704a0  20        2         15        1     515           4         
             
            RootBridge        RootPath  DesignatedBridge  Root        Max  Hel  Fwd  
            Identifier        Cost      Identifier        Port        Age  lo   Dly  
            hex                         hex                           sec  sec  sec  
            00646cb9c51613ca  1600      10643c2c992d8235  PortChannel120   2    15   
             
            STP Port Parameters:
			Port            Prio Path      Port Uplink BPDU   Guard State      Designated Designated       Designated
			Num             rity Cost      Fast Fast   Filter Type             Cost       Root             bridge 
            PortChannel1    128  800       N    N      N      -		FORWARDING 800        00646cb9c51613ca 10643c2c992d8235 
        </EXAMPLE>
    </DOCGEN>
    </COMMAND>

    <COMMAND
        name="show spanning-tree counters"
        help="Counters"
        >
        <PARAM
            name="vlan"
            help="Counters for a specific VLAN"
            ptype="SUBCOMMAND"
            mode="subcommand"
            optional="true"
            >
            <PARAM
                name="vlan-id"
                help="(-) or (,) separated individual VLAN IDs and ranges of VLAN IDs; for example, 20,70-100,142"
                ptype="VLAN_RANGE"
                >
            </PARAM>
        </PARAM>
    <ACTION builtin="clish_pyobj">
        sonic_cli_stp process_stp_show_counters show_stp_counters.j2 ${vlan-id}
    </ACTION>
    <DOCGEN>
        <DESCRIPTION>
            Shows spanning-tree counters information
        </DESCRIPTION>
        <USAGE>
            This command is useful in viewing the spanning-tree counters information
        </USAGE>
        <EXAMPLE summary="show spanning-tree counters">
            sonic(config)# do show spanning-tree counters
             
            VLAN 100 - STP instance 0
            ----------------------------------------------------------------------
            PortNum         BPDU Tx   BPDU Rx   TCN Tx    TCN Rx    
                                                                    
            ----------------------------------------------------------------------
            Ethernet0       0         0         0         0         
            Ethernet48      53        7         1         0         
            Ethernet62      0         0         0         0         
            Ethernet64      0         0         0         0         
            PortChannel1    0         76        1         0         
            PortChannel2    0         0         0         0         
            PortChannel3    0         0         0         0         
        </EXAMPLE>
    </DOCGEN>
    </COMMAND>

    <COMMAND
        name="show spanning-tree inconsistentports"
        help="Root/Loop guard information for all VLANs"
        >
        <PARAM
            name="vlan"
            help="Root/Loop guard information for a specific VLAN"
            ptype="SUBCOMMAND"
            mode="subcommand"
            optional="true"
            >
            <PARAM
                name="vlan-id"
                help="(-) or (,) separated individual VLAN IDs and ranges of VLAN IDs; for example, 20,70-100,142"
                ptype="VLAN_RANGE"
                >
            </PARAM>
        </PARAM>
    <ACTION builtin="clish_pyobj">
        sonic_cli_stp process_stp_show_inconsistentports show_stp_root_guard.j2 ${vlan-id}
    </ACTION>
    <DOCGEN>
        <DESCRIPTION>
            Shows spanning-tree root or loop inconsistent information
        </DESCRIPTION>
        <USAGE>
            This command is useful in viewing the spanning-tree root or loop inconsistent ports information
        </USAGE>
        <EXAMPLE summary="show spanning-tree inconsistentports">
            sonic# show spanning-tree inconsistentports 
             
            Root guard timeout: 30  secs
            Loop guard default: Enabled

            ----------------------------------------------------------------------
            PortNum          VLAN  Inconsistency State                          
            ----------------------------------------------------------------------
            Ethernet48       100   Root Inconsistent (29 seconds left on timer)
			Ethernet49       10    Loop Inconsistent
        </EXAMPLE>
    </DOCGEN>
    </COMMAND>

    <COMMAND
        name="show spanning-tree bpdu-guard"
        help="BPDU guard information"
        >
    <ACTION builtin="clish_pyobj">
     sonic_cli_stp get_openconfig_spanning_tree_stp_interfaces show_stp_bpdu_guard.j2
    </ACTION>
    <DOCGEN>
        <DESCRIPTION>
            Shows spanning-tree BPDU guard information
        </DESCRIPTION>
        <USAGE>
            This command is useful in viewing the spanning-tree BPDU guard information for the ports
        </USAGE>
        <EXAMPLE summary="show spanning-tree bpdu-guard">
            sonic#show spanning-tree bpdu-guard 
            PortNum         Shutdown    Port shut          
                            Configured  due to BPDU guard  
            Ethernet64       Y           N                  
            PortChannel2     Y           N                  
        </EXAMPLE>
    </DOCGEN>
    </COMMAND>
	<COMMAND
		name="show running-configuration spanning-tree"
		help="Show spanning-tree configuration">
		<ACTION builtin="clish_pyobj">sonic_cli_stp show_running_spanning_tree views=configure-view" </ACTION>
    <DOCGEN>
        <DESCRIPTION>
            Shows running-config for spanning-tree 
        </DESCRIPTION>
        <USAGE>
            This command is useful in viewing a summary of running-config for spanning-tree 
        </USAGE>
        <EXAMPLE summary="show running-config spanning-tree">
			sonic-cli# show running-configuration spanning-tree
			spanning-tree mode pvst
			spanning-tree edge-port bpdufilter default
			spanning-tree forward-time 4
			spanning-tree guard root timeout 5
			spanning-tree hello-time 1
			spanning-tree max-age 40
			spanning-tree priority 61440
			!
			no spanning-tree vlan 101
			!
			spanning-tree vlan 100 forward-time 5
			spanning-tree vlan 100 hello-time 3
			!
			spanning-tree vlan 101 forward-time 15
			!
			interface Ethernet0
			 spanning-tree bpdufilter enable
			 spanning-tree vlan 100 cost 1
			!
			interface PortChannel10
			 no spanning-tree enable
			 no spanning-tree portfast
			 spanning-tree cost 2
			 spanning-tree vlan 100 cost 1
        </EXAMPLE>
    </DOCGEN>

	</COMMAND>
</VIEW>

<!-- Config mode -->
<VIEW name="configure-view">
    <!-- no spanning tree -->
    <COMMAND
        name="no spanning-tree vlan"
        help="Disables spanning-tree on a specific VLAN"
        command_tables="sonic-spanning-tree:sonic-spanning-tree/STP_VLAN/STP_VLAN_LIST/name={vlan_name}"
        command_keys="vlan_name=*"
        render_command_cb="no_spanning_tree_vlan"
        >
        <PARAM
            name="vlan-range"
            help="(-) or (,) separated individual VLAN IDs and ranges of VLAN IDs; for example, 20,70-100,142"
            ptype="VLAN_RANGE"
            >
        </PARAM>
            <PARAM
                name="stp-vlan-subcmds"
                help="Spanning tree subcommands"
                ptype="SUBCOMMAND"
                mode="switch"
                optional="true"
                >
                <PARAM
                    name="forward-time"
                    help="Resets forward delay time to default value"
                    ptype="SUBCOMMAND"
                    mode="subcommand"
                    >
                </PARAM>
                <PARAM
                    name="hello-time"
                    help="Resets hello time to default value"
                    ptype="SUBCOMMAND"
                    mode="subcommand"
                    >
                </PARAM>

                <PARAM
                    name="max-age"
                    help="Resets max-age to default value"
                    ptype="SUBCOMMAND"
                    mode="subcommand"
                    >
                </PARAM>

                <PARAM
                    name="priority"
                    help="Resets bridge priority to default value"
                    ptype="SUBCOMMAND"
                    mode="subcommand"
                    >
                </PARAM>
            </PARAM>
    <ACTION builtin="clish_pyobj">
        sonic_cli_stp del_stp_vlan_subcmds ${stp-vlan-subcmds} ${vlan-range}&#xA;
    </ACTION>
    <DOCGEN>
        <DESCRIPTION>
            Configure spanning-tree parameters on per VLAN basis
        </DESCRIPTION>
        <USAGE>
            These commands are similar to the global level commands but allow disabling the spanning-tree parameters on per VLAN basis.
        </USAGE>
        <EXAMPLE>
            sonic(config)#no spanning-tree vlan 100  
            sonic(config)#no spanning-tree vlan 100 forward-time
            sonic(config)#no spanning-tree vlan 100 hello-time
            sonic(config)#no spanning-tree vlan 100 max-age 
            sonic(config)#no spanning-tree vlan 100 priority
        </EXAMPLE>
    </DOCGEN>
    </COMMAND>

    <COMMAND
        name="spanning-tree"
        help="Spanning tree configuration"
        >
    </COMMAND>

    <COMMAND
        name="spanning-tree mode"
        help="Configures spanning tree mode"
        command_tables="sonic-spanning-tree:sonic-spanning-tree/STP/STP_LIST/keyleaf={keyleaf_val}"
        command_keys="keyleaf_val=GLOBAL"
        >
        <PARAM
            name="mode-subcmds"
            help="Spanning tree subcommands"
            ptype="SUBCOMMAND"
            mode="switch"
            >
            <PARAM
                name="pvst"
                help="Enables PVST+ (based on IEEE 802.1D)"
                ptype="SUBCOMMAND"
                dbpath="sonic-spanning-tree:sonic-spanning-tree/STP/STP_LIST/mode=pvst"
                mode="subcommand"
                optional="true"
            >
            </PARAM>
            <PARAM
                name="rapid-pvst"
                help="Enables rapid PVST+ (based on IEEE 802.1w)"
                ptype="SUBCOMMAND"
                dbpath="sonic-spanning-tree:sonic-spanning-tree/STP/STP_LIST/mode=rpvst"
                mode="subcommand"
                optional="true"
                >
            </PARAM>
        </PARAM>
    <ACTION builtin="clish_pyobj">
        sonic_cli_stp set_stp_global_mode ${__params}&#xA;
    </ACTION>
    <DOCGEN>
        <DESCRIPTION>
            Configure the global spanning-tree mode for the device
        </DESCRIPTION>
        <USAGE>
            This command allows configuring the spanning-tree mode for the device. There are 2 modes supported - pvst and rapid-pvst.
        </USAGE>
        <EXAMPLE>
            sonic(config)#spanning-tree mode pvst
        </EXAMPLE>
    </DOCGEN>
    </COMMAND>

    <COMMAND
        name="spanning-tree edge-port"
        help="Edge-port configuration"
        command_tables="sonic-spanning-tree:sonic-spanning-tree/STP/STP_LIST/keyleaf={keyleaf_val}"
        command_keys="keyleaf_val=GLOBAL"
        >
        <PARAM
            name="bpdufilter"
            help="BPDU Filter options"
            ptype="SUBCOMMAND"
            mode="subcommand"
            >
            <PARAM
                name="default"
                help="Enables bpdufilter on edge-ports"
                dbpath="sonic-spanning-tree:sonic-spanning-tree/STP/STP_LIST/bpdu_filter=true"
                ptype="SUBCOMMAND"
                mode="subcommand"
            >
            </PARAM>
        </PARAM>
    <ACTION builtin="clish_pyobj">
        sonic_cli_stp set_stp_global_bpdu_filter True&#xA;
    </ACTION>
    <DOCGEN>
        <DESCRIPTION>
            Configure spanning-tree global level BPDU filter
        </DESCRIPTION>
        <USAGE>
            This command allows configuring global level BPDU filter
        </USAGE>
        <EXAMPLE>
            sonic(config)# spanning-tree edge-port bpdufilter default
        </EXAMPLE>
    </DOCGEN>
    </COMMAND>

    <COMMAND
        name="spanning-tree forward-time"
        help="Configures forward delay time"
        command_tables="sonic-spanning-tree:sonic-spanning-tree/STP/STP_LIST/keyleaf={keyleaf_val}"
        command_keys="keyleaf_val=GLOBAL"
        render_command_cb="spanning_tree_global_fwd_delay"
        ptype="SUBCOMMAND"
        mode="subcommand"
        >
        <PARAM
            name="seconds"
            help="Forward time value (sec)"
            ptype="STP_FORWARD_DELAY"
            >
        </PARAM>
    <ACTION builtin="clish_pyobj"> sonic_cli_stp set_stp_global_forwarding_delay ${seconds}&#xA;
    </ACTION>
    <DOCGEN>
        <DESCRIPTION>
            Configure the spanning-tree forward delay time.
        </DESCRIPTION>
        <USAGE>
            This command allows configuring the forward delay time in seconds (default = 15), range 4-30.
        </USAGE>
        <EXAMPLE>
            sonic(config)# spanning-tree forward-time 20
        </EXAMPLE>
    </DOCGEN>
    </COMMAND>

    <COMMAND
        name="spanning-tree guard"
        help="Guard configuration"
        command_tables="sonic-spanning-tree:sonic-spanning-tree/STP/STP_LIST/keyleaf={keyleaf_val}"
        command_keys="keyleaf_val=GLOBAL"
        ptype="SUBCOMMAND" mode="subcommand"
        render_command_cb="spanning_tree_global_root_guard_timeout"
        >
        <PARAM
            name="root"
            help="Root guard options"
            ptype="SUBCOMMAND" mode="subcommand"
            >
            <PARAM
                name="timeout"
                help="Configures root guard timeout"
                ptype="SUBCOMMAND"
                mode="subcommand"
                >
                <PARAM
                    name="value"
                    help="Timeout value (sec)"
                    ptype="STP_GUARD_ROOT_TIMEOUT"
                    dbpath="sonic-spanning-tree:sonic-spanning-tree/STP/STP_LIST/rootguard_timeout"
                >
                </PARAM>
            </PARAM>
        </PARAM>
    <ACTION builtin="clish_pyobj"> sonic_cli_stp set_stp_global_rootguard_timeout ${value}&#xA;
    </ACTION>
    <DOCGEN>
        <DESCRIPTION>
            Configure the spanning-tree root guard timeout.
        </DESCRIPTION>
        <USAGE>
            This command allows configuring a root guard timeout value. Once superior BPDUs stop coming on the port, device will wait for a period until root guard timeout before moving the port to forwarding state(default = 30 secs), range 5-600.
        </USAGE>
        <EXAMPLE>
            sonic(config)# spanning-tree guard root timeout 10
        </EXAMPLE>
    </DOCGEN>
    </COMMAND>

    <COMMAND
        name="spanning-tree hello-time"
        help="Configures hello time"
        command_tables="sonic-spanning-tree:sonic-spanning-tree/STP/STP_LIST/keyleaf={keyleaf_val}"
        command_keys="keyleaf_val=GLOBAL"
        render_command_cb="spanning_tree_global_hello_time"
        ptype="SUBCOMMAND"
        mode="subcommand"
        >
        <PARAM
            name="seconds"
            help="Hello time value (sec)"
            ptype="STP_HELLO_TIME"
            >
        </PARAM>
    <ACTION builtin="clish_pyobj"> sonic_cli_stp set_stp_global_hello_time ${seconds}&#xA;
    </ACTION>
    <DOCGEN>
        <DESCRIPTION>
            Configure the spanning-tree hello time value.
        </DESCRIPTION>
        <USAGE>
            This command allow configuring the hello interval in secs for transmission of bpdus (default = 2), range 1-10.
        </USAGE>
        <EXAMPLE>
            sonic(config)# spanning-tree hello-time 3
        </EXAMPLE>
    </DOCGEN>
    </COMMAND>

    <COMMAND
        name="spanning-tree max-age"
        help="Configures max-age time"
        command_tables="sonic-spanning-tree:sonic-spanning-tree/STP/STP_LIST/keyleaf={keyleaf_val}"
        command_keys="keyleaf_val=GLOBAL"
        ptype="SUBCOMMAND"
        render_command_cb="spanning_tree_global_max_age"
        mode="subcommand"
        >
        <PARAM
            name="seconds"
            help="Max-age time value (sec)"
            ptype="STP_MAX_AGE"
            >
        </PARAM>
    <ACTION builtin="clish_pyobj"> sonic_cli_stp set_stp_global_max_age ${seconds}&#xA;
    </ACTION>
    <DOCGEN>
        <DESCRIPTION>
            Configure the spanning-tree max-age time value.
        </DESCRIPTION>
        <USAGE>
            This command allows configuring the maximum time to listen for root bridge in seconds (default = 20), range 6-40.
        </USAGE>
        <EXAMPLE>
            sonic(config)# spanning-tree max-age 22
        </EXAMPLE>
    </DOCGEN>
    </COMMAND>

    <COMMAND
        name="spanning-tree priority"
        help="Configures bridge priority"
        command_tables="sonic-spanning-tree:sonic-spanning-tree/STP/STP_LIST/keyleaf={keyleaf_val}"
        command_keys="keyleaf_val=GLOBAL"
        ptype="SUBCOMMAND"
        render_command_cb="spanning_tree_global_priority"
        mode="subcommand"
        >
        <PARAM
            name="value"
            help="Bridge priority value (multiples of 4096)"
            ptype="STP_PRIORITY"
            >
        </PARAM>
    <ACTION builtin="clish_pyobj"> sonic_cli_stp set_stp_global_bridge_priority ${value}&#xA;
    </ACTION>
    <DOCGEN>
        <DESCRIPTION>
            Configure the global level spanning-tree bridge priority value.
        </DESCRIPTION>
        <USAGE>
            This command allows configuring the bridge priority in increments of 4096, range 0-61440
        </USAGE>
        <EXAMPLE>
            sonic(config)# spanning-tree priority 4096
        </EXAMPLE>
    </DOCGEN>
    </COMMAND>

    <COMMAND
        name="spanning-tree loopguard"
        help="Enable spanning tree loopguard"
        ptype="SUBCOMMAND" mode="subcommand"
        command_tables="sonic-spanning-tree:sonic-spanning-tree/STP/STP_LIST/keyleaf={keyleaf_val}"
        command_keys="keyleaf_val=GLOBAL"
        render_command_cb="spanning_tree_global_loop_guard"
        >
        <PARAM
            name="default"
            help="Enable loopguard by default on all ports"
        	ptype="SUBCOMMAND" mode="subcommand"
            >
        </PARAM>
        <ACTION builtin="clish_pyobj"> sonic_cli_stp set_stp_global_loop_guard True&#xA;
		</ACTION>
    <DOCGEN>
        <DESCRIPTION>
            Configure the spanning-tree loop guard.
        </DESCRIPTION>
        <USAGE>
            This command allows to enable loop guard globally on all ports. When loop guard is enabled and if BPDUs are not received on a non-designated port, that port is moved into the STP loop-inconsistent blocking state, instead of the listening / learning / forwarding state.
        </USAGE>
        <EXAMPLE>
            sonic(config)# spanning-tree loopguard default
        </EXAMPLE>
    </DOCGEN>
    </COMMAND>

    <COMMAND
        name="spanning-tree portfast"
        help="Enable spanning tree portfast"
        ptype="SUBCOMMAND" mode="subcommand"
        command_tables="sonic-spanning-tree:sonic-spanning-tree/STP/STP_LIST/keyleaf={keyleaf_val}"
        command_keys="keyleaf_val=GLOBAL"
        render_command_cb="spanning_tree_global_portfast"
        >
        <PARAM
            name="default"
            help="Enable portfast by default on all access ports"
        	ptype="SUBCOMMAND" mode="subcommand"
            >
        </PARAM>
        <ACTION builtin="clish_pyobj"> sonic_cli_stp set_stp_global_portfast True&#xA;
		</ACTION>
    <DOCGEN>
        <DESCRIPTION>
            Configure the spanning-tree portfast.
        </DESCRIPTION>
        <USAGE>
            This command allows to enable portfast globally on all access ports. When portfast is enabled, port transitions from blocking to forwarding state immediately, bypassing the usual 802.1D STP transition states.
        </USAGE>
        <EXAMPLE>
            sonic(config)# spanning-tree portfast default
        </EXAMPLE>
    </DOCGEN>
    </COMMAND>

    <!-- no spanning tree -->

    <COMMAND
        name="no spanning-tree"
        help="Spanning tree configuration"
        >
    </COMMAND>

    <COMMAND
        name="no spanning-tree edge-port"
        help="Edge port configuration"
        >
        <PARAM
            name="bpdufilter"
            help="BPDU filter options"
            ptype="SUBCOMMAND"
            mode="subcommand"
            >
            <PARAM
                name="default"
                help="Disables bpdufilter on all edge ports"
                ptype="SUBCOMMAND"
                mode="subcommand"
            >
            </PARAM>
        </PARAM>
    <ACTION builtin="clish_pyobj"> sonic_cli_stp set_stp_global_bpdu_filter False&#xA;
    </ACTION>
    </COMMAND>

    <COMMAND
        name="no spanning-tree mode"
        help="Disables spanning tree"
        >
    <ACTION builtin="clish_pyobj">
        sonic_cli_stp del_stp_global_mode
    </ACTION>
    <DOCGEN>
        <DESCRIPTION>
            Disable global spanning-tree mode for the device
        </DESCRIPTION>
        <USAGE>
            This command allows disabling the spanning-tree mode for the device.
        </USAGE>
        <EXAMPLE>
            sonic(config)#no spanning-tree mode
        </EXAMPLE>
    </DOCGEN>
    </COMMAND>

    <COMMAND
        name="no spanning-tree forward-time"
        help="Resets forward time to default value"
        ptype="SUBCOMMAND"
        mode="subcommand"
        >
    <ACTION builtin="clish_pyobj"> sonic_cli_stp del_stp_global_forwarding_delay&#xA;
    </ACTION>
    <DOCGEN>
        <DESCRIPTION>
            Remove the spanning-tree forward delay time configuration
        </DESCRIPTION>
        <USAGE>
            This command allows resetting the forward delay time to default value
        </USAGE>
        <EXAMPLE>
            sonic(config)# no spanning-tree forward-time
        </EXAMPLE>
    </DOCGEN>
    </COMMAND>

    <COMMAND
        name="no spanning-tree guard"
        help="Guard configuration"
        ptype="SUBCOMMAND" mode="subcommand"
        >
        <PARAM
            name="root"
            help="Root guard options"
            ptype="SUBCOMMAND" mode="subcommand"
            >
            <PARAM
                name="timeout"
                help="Resets root guard timeout to default value"
                ptype="SUBCOMMAND"
                mode="subcommand"
                >
            </PARAM>
        </PARAM>
    <ACTION builtin="clish_pyobj"> sonic_cli_stp del_stp_global_rootguard_timeout&#xA;
    </ACTION>
    <DOCGEN>
        <DESCRIPTION>
            Remove the spanning-tree root guard timeout.
        </DESCRIPTION>
        <USAGE>
            This command allows resetting the root guard timeout value. 
        </USAGE>
        <EXAMPLE>
            sonic(config)# no spanning-tree guard root timeout
        </EXAMPLE>
    </DOCGEN>
    </COMMAND>

    <COMMAND
        name="no spanning-tree hello-time"
        help="Resets hello time to default value"
        ptype="SUBCOMMAND"
        mode="subcommand"
        >
    <ACTION builtin="clish_pyobj"> sonic_cli_stp del_stp_global_hello_time&#xA;
    </ACTION>
    <DOCGEN>
        <DESCRIPTION>
            Remove the spanning-tree hello time configuration.
        </DESCRIPTION>
        <USAGE>
            This command allows resetting the hello interval configuration.
        </USAGE>
        <EXAMPLE>
            sonic(config)#no spanning-tree hello-time
        </EXAMPLE>
    </DOCGEN>
    </COMMAND>

    <COMMAND
        name="no spanning-tree max-age"
        help="Resets max-age to default value"
        ptype="SUBCOMMAND"
        mode="subcommand"
        >
    <ACTION builtin="clish_pyobj"> sonic_cli_stp del_stp_global_max_age&#xA;
    </ACTION>
    <DOCGEN>
        <DESCRIPTION>
            Remove the spanning-tree max-age time value.
        </DESCRIPTION>
        <USAGE>
            This command allows resetting the max age configuration.
        </USAGE>
        <EXAMPLE>
            sonic(config)#no spanning-tree max-age
        </EXAMPLE>
    </DOCGEN>
    </COMMAND>

    <COMMAND
        name="no spanning-tree priority"
        help="Resets bridge priority to default value"
        ptype="SUBCOMMAND"
        mode="subcommand"
        >
    <ACTION builtin="clish_pyobj"> sonic_cli_stp del_stp_global_bridge_priority&#xA;
    </ACTION>
    <DOCGEN>
        <DESCRIPTION>
            Remove the global level spanning-tree bridge priority value.
        </DESCRIPTION>
        <USAGE>
            This command allows resetting the bridge priority to default value
        </USAGE>
        <EXAMPLE>
            sonic(config)#no spanning-tree priority
        </EXAMPLE>
    </DOCGEN>
    </COMMAND>

    <COMMAND
        name="no spanning-tree loopguard"
        help="Disable spanning tree loopguard"
        ptype="SUBCOMMAND" mode="subcommand"
        >
        <PARAM
            name="default"
            help="Disable loopguard by default on all ports"
        	ptype="SUBCOMMAND" mode="subcommand"
            >
        </PARAM>
        <ACTION builtin="clish_pyobj"> sonic_cli_stp set_stp_global_loop_guard False&#xA;
		</ACTION>
    <DOCGEN>
        <DESCRIPTION>
            Disable spanning-tree loop guard configuration globally.
        </DESCRIPTION>
        <USAGE>
            This command allows to disable loop guard globally.
        </USAGE>
        <EXAMPLE>
            sonic(config)# no spanning-tree loopguard default 
        </EXAMPLE>
    </DOCGEN>
    </COMMAND>

    <COMMAND
        name="no spanning-tree portfast"
        help="Disable spanning tree portfast"
        ptype="SUBCOMMAND" mode="subcommand"
        >
        <PARAM
            name="default"
            help="Disable portfast by default on all access ports"
        	ptype="SUBCOMMAND" mode="subcommand"
            >
        </PARAM>
        <ACTION builtin="clish_pyobj"> sonic_cli_stp set_stp_global_portfast False&#xA;
		</ACTION>
    <DOCGEN>
        <DESCRIPTION>
            Disable spanning-tree portfast configuration globally.
        </DESCRIPTION>
        <USAGE>
            This command allows to disable portfast globally.
        </USAGE>
        <EXAMPLE>
            sonic(config)# no spanning-tree portfast default 
        </EXAMPLE>
    </DOCGEN>
    </COMMAND>

    <COMMAND
        name="spanning-tree vlan"
        help="Enables spanning-tree on a specific VLAN"
        command_tables="sonic-spanning-tree:sonic-spanning-tree/STP_VLAN/STP_VLAN_LIST/name={vlan_name};sonic-spanning-tree:sonic-spanning-tree/STP/STP_LIST/keyleaf={keyleaf_val}"
        command_keys="keyleaf_val=GLOBAL;vlan_name=*"
        render_command_cb="spanning_tree_vlan"
        >
        <PARAM
            name="vlan-range"
            help="(-) or (,) separated individual VLAN IDs and ranges of VLAN IDs; for example, 20,70-100,142"
            ptype="VLAN_RANGE"
            dbpath="sonic-spanning-tree:sonic-spanning-tree/STP_VLAN/STP_VLAN_LIST/vlanid"
            >
        </PARAM>
        <PARAM
            name="stp-vlan-subcmds"
            help="Spanning tree subcommands"
            ptype="SUBCOMMAND"
            mode="switch"
            optional="true"
            >
            <PARAM
                name="forward-time"
                help="Configures forward delay time"
                ptype="SUBCOMMAND"
                mode="subcommand"
                >
                <PARAM
                    name="seconds"
                    help="Forward delay time (sec)"
                    dbpath="sonic-spanning-tree:sonic-spanning-tree/STP_VLAN/STP_VLAN_LIST/forward_delay"
                    ptype="STP_FORWARD_DELAY"
                    >
                </PARAM>
            </PARAM>
            <PARAM
                name="hello-time"
                help="Configures hello time"
                ptype="SUBCOMMAND"
                mode="subcommand"
                >
                <PARAM
                    name="seconds"
                    help="Hello time (sec)"
                    ptype="STP_HELLO_TIME"
                    dbpath="sonic-spanning-tree:sonic-spanning-tree/STP_VLAN/STP_VLAN_LIST/hello_time"
                    >
                </PARAM>
            </PARAM>

            <PARAM
                name="max-age"
                help="Configures max-age time"
                ptype="SUBCOMMAND"
                mode="subcommand"
                >
                <PARAM
                    name="seconds"
                    help="Max-age time value (sec)"
                    dbpath="sonic-spanning-tree:sonic-spanning-tree/STP_VLAN/STP_VLAN_LIST/max_age"
                    ptype="STP_MAX_AGE"
                    >
                </PARAM>
            </PARAM>
            <PARAM
                name="priority"
                help="Configures bridge priority"
                ptype="SUBCOMMAND"
                mode="subcommand"
                >
                <PARAM
                    name="value"
                    help="Bridge priority value (multiples of 4096)"
                    dbpath="sonic-spanning-tree:sonic-spanning-tree/STP_VLAN/STP_VLAN_LIST/priority"
                    ptype="STP_PRIORITY"
                    >
                </PARAM>
            </PARAM>
        </PARAM>
    <ACTION builtin="clish_pyobj">
        sonic_cli_stp set_stp_vlan_subcmds ${stp-vlan-subcmds} ${vlan-range} ${seconds} ${value}&#xA;
    </ACTION>
    <DOCGEN>
        <DESCRIPTION>
            Configure spanning-tree parameters on per VLAN basis
        </DESCRIPTION>
        <USAGE>
            These commands are similar to the global level commands but allow configuring the spanning-tree parameters on per VLAN basis.
        </USAGE>
        <EXAMPLE>
            sonic(config)#spanning-tree vlan 100  
            sonic(config)#spanning-tree vlan 100 forward-time 11
            sonic(config)#spanning-tree vlan 100 hello-time 3
            sonic(config)#spanning-tree vlan 100 max-age 22 
            sonic(config)#spanning-tree vlan 100 priority 4096 
        </EXAMPLE>
    </DOCGEN>
    </COMMAND>


</VIEW>


<!-- Config interface mode -->
<VIEW name="configure-if-view">
    <MACRO name="STP-INTF-CMDS" arg="${iface}"></MACRO>
</VIEW>

<!-- Config lag mode -->
<VIEW name="configure-lag-view">
    <MACRO name="STP-INTF-CMDS" arg="${po_name}"></MACRO>
</VIEW>

</CLISH_MODULE>
