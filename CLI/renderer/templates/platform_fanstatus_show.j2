{{'-----------------------------------------------------------------------'}}
{{'Fan'.ljust(15)}}{{'Status'.ljust(15)}}{{'Speed (RPM)'.ljust(20)}}{{'Direction'.ljust(20)}}
{{'-----------------------------------------------------------------------'}}

{% for fan_name, fan_info in json_output.items() %}
{% set description = 'None' %}
{% set direction = 'N/A' %}
{% set speed = 'N/A' %}

{% if 'state' in fan_info %}
{% if 'oper-status' in fan_info['state'] %}
{% if fan_info['state']['oper-status'] == 'openconfig-platform-types:ACTIVE' %}
{% set oper_status = 'OK' %}
{% else %}
{% set oper_status = 'NOT OK' %}
{% endif %}
{% endif %}

{% if 'name' in fan_info['state'] %}
{% set description = fan_info['state']['name'] %}
{% endif %}
{% endif %}

{% set direction = 'None' %}
{% set speed = 0 %}

{% if 'fan' in fan_info %}
{% if 'state' in fan_info['fan'] %}
{% if 'openconfig-platform-ext:direction' in fan_info['fan']['state'] %}
{% set direction = fan_info['fan']['state']['openconfig-platform-ext:direction'] %}
{% endif %}

{% if 'openconfig-platform-fan:speed' in fan_info['fan']['state'] %}
{% set speed = fan_info['fan']['state']['openconfig-platform-fan:speed'] %}
{% endif %}

{% endif %}
{% endif %}
{% if speed == 'N/A' %}
{{fan_name.ljust(15)}}{{oper_status.ljust(15)}}{{'N/A'.ljust(18)}}{{direction}}
{% else %}
{{fan_name.ljust(15)}}{{oper_status.ljust(15)}}{{'%d'.ljust(18) | format(speed|int)}}{{direction}}
{% endif %}
{% endfor %}

