<!DOCTYPE busconfig PUBLIC
 "-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN"
 "http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd">
<busconfig>

  <!-- Only allow root to own the HAM bus. -->
  <policy user="root">
    <allow own_prefix="org.SONiC.HostAccountManagement"/>
  </policy>

  <!-- Allow everybody ("default") to invoke methods from
       the ham.name_service interface except for "ham.name_service.getspnam"
       which should only be invoked by members of the hamd group -->
  <policy context="default">
    <allow receive_sender="org.SONiC.HostAccountManagement"
           receive_interface="ham.name_service"/>
    <allow send_destination="org.SONiC.HostAccountManagement"
           send_interface="ham.name_service"/>
    <deny send_destination="org.SONiC.HostAccountManagement"
          send_interface="ham.name_service" send_member="getspnam"/>
  </policy>

  <!-- Only allow members of the group "hamd_accounts" to invoke
       methods from the ham.accounts interface -->
  <policy group="hamd_accounts">
    <allow receive_sender="org.SONiC.HostAccountManagement"
           receive_interface="ham.accounts"/>
    <allow send_destination="org.SONiC.HostAccountManagement"
           send_interface="ham.accounts"/>
  </policy>

  <!-- Allow members of the group "hamd" to invoke everything on the bus. -->
  <policy group="hamd">
    <allow receive_sender="org.SONiC.HostAccountManagement"/>
    <allow send_destination="org.SONiC.HostAccountManagement"/>
  </policy>

  <!-- Allow root to invoke everything on the bus. -->
  <policy user="root">
    <allow receive_sender="org.SONiC.HostAccountManagement"/>
    <allow send_destination="org.SONiC.HostAccountManagement"/>
  </policy>

</busconfig>
